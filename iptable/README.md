# iptables一键配置端口转发脚本
CentOS 7 默认的防火墙是 firewall，要使用本脚本，请先卸载或关闭 firewall 服务器，并安装 iptables 全套软件。

## 安装使用
下载iptables一键配置端口转发脚本，并赋予执行权限运行

```
wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubiBackup/doubi/master/iptables-pf.sh && chmod +x iptables-pf.sh && bash iptables-pf.sh
```
下载并运行脚本后，先选择  1. 安装 iptables ，会检测是否安装 iptables 同时也会进行 iptables 防火墙开机启动加载等配置。
## 使用方法
```
./iptables-pf.sh
```
运行脚本后，会显示菜单：

```
iptables 端口转发一键管理脚本 [vx.x.x]
-- Toyo | doub.io/wlzy-20 --
0. 升级脚本
————————————
1. 安装 iptables
2. 清空 iptables 端口转发
————————————
3. 查看 iptables 端口转发
4. 添加 iptables 端口转发
5. 删除 iptables 端口转发
————————————
```
注意：初次使用前请请务必执行 1. 安装 iptables(不仅仅是安装)
请输入数字 [0–5]:
选择 4. 添加 iptables 端口转发 后，会提示你依次输入 欲转发IP、欲转发端口、本地监听端口、本地IP、
```
转发类型：
请输入 iptables 欲转发至的 远程端口 [1-65535] (支持端口段 如 2333-6666, 被转发服务器):10000-11000
欲转发端口 : 10000-11000
请输入 iptables 欲转发至的 远程IP(被转发服务器):2.2.2.2
欲转发服务器IP : 2.2.2.2
请输入 iptables 本地监听端口 [1-65535] (支持端口段 如 2333-6666)
(默认端口: 10000-11000):
本地监听端口 : 10000-11000
请输入 本服务器的 公网IP网卡IP(注意是网卡绑定的IP，而不仅仅是公网IP，回车自动检测):
本服务器IP : 1.1.1.1
请输入数字 来选择 iptables 转发类型:
1. TCP
2. UDP
3. TCP+UDP
(默认: TCP+UDP):
——————————————————————————————
请检查 iptables 端口转发规则配置是否有误 !
本地监听端口 : 10000-11000
服务器 IP : 2.2.2.2
欲转发的端口 : 10000-11000
欲转发 IP : 1.1.1.1
转发类型 : TCP+UDP
——————————————————————————————
```
最后会提示你确认配置是否有误，如果没有问题就按任意键继续，启动成功后就会提示
```
——————————————————————————————
iptables 端口转发规则配置完成 !
本地监听端口 : 10000:11000
服务器 IP : 1.1.1.1
欲转发的端口 : 10000:11000
欲转发 IP : 2.2.2.2
转发类型 : TCP+UDP
——————————————————————————————
```
选择 3. 查看 iptables 端口转发 后，会显示如下
```
当前有 2 个 iptables 端口转发规则。
1. 类型: tcp 监听端口: 10000:20000 转发IP和端口: 2.2.2.2:10000-20000
2. 类型: udp 监听端口: 10000:20000 转发IP和端口: 2.2.2.2:10000-20000
```
选择 5. 删除 iptables 端口转发 后，也会显示列表，然后让你选择 要删除的端口转发规则序号。
